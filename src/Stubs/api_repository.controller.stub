<?php

namespace {{ namespace }};

use App\Http\Controllers\Controller;
use {{ storeRequestNamespace }};
use {{ updateRequestNamespace }};
use {{ resourceNamespace }};
use {{ serviceNamespace }};
use Illuminate\Http\Request;
use Symfony\Component\HttpFoundation\Response;

class {{ class }} extends Controller
{
    /**
     * @var {{ service }}
     */
    protected {{ service }} ${{ serviceVariable }};

    /**
     * DummyModel Constructor
     *
     * @param {{ service }} ${{ serviceVariable }}
     *
     */
    public function __construct({{ service }} ${{ serviceVariable }})
    {
        $this->{{ serviceVariable }} = ${{ serviceVariable }};
    }

    public function index(): \Illuminate\Http\Resources\Json\AnonymousResourceCollection
    {
        return {{ resource }}::collection($this->{{ serviceVariable }}->getAll());
    }

    public function store({{ storeRequest }} $request): {{ resource }}|\Illuminate\Http\JsonResponse
    {
        try {
            return new {{ resource }}($this->{{ serviceVariable }}->save($request->validated()));
        } catch (\Exception $exception) {
            report($exception);
            return response()->json([
                'message' => config('laravel_auto_crud.error_messages.store', 'An error occurred while creating the resource.'),
            ], Response::HTTP_INTERNAL_SERVER_ERROR);
        }
    }

    public function show(int $id): {{ resource }}
    {
        return {{ resource }}::make($this->{{ serviceVariable }}->getById($id));
    }

    public function update({{ updateRequest }} $request, int $id): {{ resource }}|\Illuminate\Http\JsonResponse
    {
        try {
            return new {{ resource }}($this->{{ serviceVariable }}->update($request->validated(), $id));
        } catch (\Exception $exception) {
            report($exception);
            return response()->json([
                'message' => config('laravel_auto_crud.error_messages.update', 'An error occurred while updating the resource.'),
            ], Response::HTTP_INTERNAL_SERVER_ERROR);
        }
    }

    public function destroy(int $id): \Illuminate\Http\JsonResponse
    {
        try {
            $this->{{ serviceVariable }}->deleteById($id);
            return response()->json(['message' => 'Deleted successfully'], Response::HTTP_OK);
        } catch (\Exception $exception) {
            report($exception);
            return response()->json([
                'message' => config('laravel_auto_crud.error_messages.delete', 'An error occurred while deleting the resource.'),
            ], Response::HTTP_INTERNAL_SERVER_ERROR);
        }
    }
}
